# DiskJockey æ”¯æŒçš„æ ‡ç­¾å­—æ®µè¯´æ˜

## ğŸ“‹ å½“å‰æ”¯æŒçš„æ ‡ç­¾

ä»£ç ç›®å‰æ”¯æŒä¿®æ”¹ä»¥ä¸‹ **6 ä¸ªæ ‡ç­¾å­—æ®µ**ï¼š

### 1. æ ‡é¢˜ (Title) âœ… **å¿…éœ€å­—æ®µ**
- **è¯´æ˜**ï¼šæ­Œæ›²åç§°
- **æ•°æ®æ¥æº**ï¼šä» AcoustID API çš„ `recording.title` è·å–
- **æ‰€æœ‰æ ¼å¼æ”¯æŒ**ï¼šâœ…

### 2. è‰ºæœ¯å®¶ (Artist) âœ… **å¿…éœ€å­—æ®µ**
- **è¯´æ˜**ï¼šæ¼”å”±è€…/è‰ºæœ¯å®¶åç§°
- **æ•°æ®æ¥æº**ï¼šä» AcoustID API çš„ `recording.artists[0].name` è·å–
- **æ‰€æœ‰æ ¼å¼æ”¯æŒ**ï¼šâœ…

### 3. ä¸“è¾‘ (Album) â­ **å¯é€‰å­—æ®µ**
- **è¯´æ˜**ï¼šä¸“è¾‘åç§°
- **æ•°æ®æ¥æº**ï¼šä»å¤šä¸ªæ¥æºè·å–ï¼ˆä¼˜å…ˆçº§é¡ºåºï¼‰ï¼š
  1. `result.releases[0].title`
  2. `recording.releases[0].title`
  3. `result.releasegroups[0].title`
  4. `recording.releasegroups[0].title`
- **æ‰€æœ‰æ ¼å¼æ”¯æŒ**ï¼šâœ…

### 4. å¹´ä»½ (Year/Date) â­ **å¯é€‰å­—æ®µ**
- **è¯´æ˜**ï¼šå‘è¡Œå¹´ä»½
- **æ•°æ®æ¥æº**ï¼šä» `release.date` æˆ– `release.date.year` è·å–
- **æ‰€æœ‰æ ¼å¼æ”¯æŒ**ï¼šâœ…
- **æ³¨æ„**ï¼šå¦‚æœ API è¿”å›å®Œæ•´æ—¥æœŸï¼ˆå¦‚ "2002-01-01"ï¼‰ï¼Œä»£ç ä¼šè‡ªåŠ¨æå–å¹´ä»½éƒ¨åˆ†

### 5. æµæ´¾ (Genre) â­ **å¯é€‰å­—æ®µ**
- **è¯´æ˜**ï¼šéŸ³ä¹ç±»å‹/æµæ´¾
- **æ•°æ®æ¥æº**ï¼šä» `releasegroup.type` è·å–ï¼ˆé€šå¸¸æ˜¯ "Album", "Single", "EP" ç­‰ï¼‰
- **æ‰€æœ‰æ ¼å¼æ”¯æŒ**ï¼šâœ…
- **æ³¨æ„**ï¼šè¿™ä¸ªå­—æ®µå®é™…ä¸Šå­˜å‚¨çš„æ˜¯ä¸“è¾‘ç±»å‹ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„éŸ³ä¹æµæ´¾

### 6. æ›²ç›®å· (Track Number) â­ **å¯é€‰å­—æ®µ**
- **è¯´æ˜**ï¼šä¸“è¾‘ä¸­çš„æ›²ç›®ç¼–å·
- **æ•°æ®æ¥æº**ï¼šä» `recording.tracks[0].position` è·å–
- **æ‰€æœ‰æ ¼å¼æ”¯æŒ**ï¼šâœ…

---

## ğŸµ å„æ ¼å¼å®ç°æ–¹å¼

### MP3 æ ¼å¼ (ID3v2)
```python
audio['title'] = title
audio['artist'] = artist
audio['album'] = album
audio['date'] = str(year)      # å­˜å‚¨ä¸ºæ—¥æœŸå­—æ®µ
audio['genre'] = genre
audio['tracknumber'] = str(tracknumber)
```

### FLAC æ ¼å¼ (Vorbis Comment)
```python
audio['title'] = title
audio['artist'] = artist
audio['album'] = album
audio['date'] = str(year)      # å­˜å‚¨ä¸ºæ—¥æœŸå­—æ®µ
audio['genre'] = genre
audio['tracknumber'] = str(tracknumber)
```

### M4A æ ¼å¼ (iTunes/MP4)
```python
audio['\xa9nam'] = title           # æ ‡é¢˜
audio['\xa9ART'] = artist          # è‰ºæœ¯å®¶
audio['\xa9alb'] = album           # ä¸“è¾‘
audio['\xa9day'] = str(year)       # å¹´ä»½
audio['\xa9gen'] = genre           # æµæ´¾
audio['trkn'] = [(int(tracknumber), 0)]  # æ›²ç›®å·ï¼ˆå…ƒç»„æ ¼å¼ï¼‰
```

### WMA æ ¼å¼ (Windows Media)
```python
audio['Title'] = title
audio['Author'] = artist
audio['WM/AlbumTitle'] = album
audio['WM/Year'] = str(year)
audio['WM/Genre'] = genre
audio['WM/TrackNumber'] = str(tracknumber)
```

---

## ğŸ“Š æ ‡ç­¾æ”¯æŒæƒ…å†µæ±‡æ€»è¡¨

| æ ‡ç­¾å­—æ®µ | MP3 | FLAC | M4A | WMA | å¿…éœ€/å¯é€‰ | æ•°æ®æ¥æº |
|---------|-----|------|-----|-----|----------|---------|
| **æ ‡é¢˜** | âœ… | âœ… | âœ… | âœ… | **å¿…éœ€** | recording.title |
| **è‰ºæœ¯å®¶** | âœ… | âœ… | âœ… | âœ… | **å¿…éœ€** | recording.artists[0].name |
| **ä¸“è¾‘** | âœ… | âœ… | âœ… | âœ… | å¯é€‰ | releases/releasegroups |
| **å¹´ä»½** | âœ… | âœ… | âœ… | âœ… | å¯é€‰ | release.date |
| **æµæ´¾** | âœ… | âœ… | âœ… | âœ… | å¯é€‰ | releasegroup.type |
| **æ›²ç›®å·** | âœ… | âœ… | âœ… | âœ… | å¯é€‰ | recording.tracks[0].position |

---

## ğŸ” æ•°æ®è·å–é€»è¾‘

ä»£ç ä¼šå°è¯•ä»å¤šä¸ªæ•°æ®æºè·å–ä¿¡æ¯ï¼ŒæŒ‰ä¼˜å…ˆçº§é¡ºåºï¼š

### ä¸“è¾‘ä¿¡æ¯è·å–ä¼˜å…ˆçº§
1. `result.releases[0].title` - æœ€é«˜ä¼˜å…ˆçº§
2. `recording.releases[0].title` - æ¬¡ä¼˜å…ˆçº§
3. `result.releasegroups[0].title` - å¤‡é€‰
4. `recording.releasegroups[0].title` - æœ€åå¤‡é€‰

### å¹´ä»½ä¿¡æ¯è·å–
- ä¼˜å…ˆä» `result.releases[0].date` è·å–
- å¦‚æœä¸å­˜åœ¨ï¼Œä» `recording.releases[0].date` è·å–
- è‡ªåŠ¨å¤„ç†æ—¥æœŸæ ¼å¼ï¼ˆYYYY-MM-DD æˆ– YYYYï¼‰

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. å¿…éœ€å­—æ®µ vs å¯é€‰å­—æ®µ
- **æ ‡é¢˜** å’Œ **è‰ºæœ¯å®¶** æ˜¯å¿…éœ€å­—æ®µï¼Œå¦‚æœ API æ²¡æœ‰è¿”å›è¿™äº›ä¿¡æ¯ï¼Œæ–‡ä»¶ä¸ä¼šè¢«å¤„ç†
- å…¶ä»–å­—æ®µéƒ½æ˜¯å¯é€‰çš„ï¼Œå¦‚æœ API æ²¡æœ‰è¿”å›ï¼Œä¼šè·³è¿‡è¯¥å­—æ®µçš„æ›´æ–°

### 2. æ•°æ®å¯ç”¨æ€§
- ä¸æ˜¯æ‰€æœ‰æ­Œæ›²éƒ½èƒ½ä» AcoustID API è·å–å®Œæ•´ä¿¡æ¯
- æŸäº›å­—æ®µå¯èƒ½ä¸ºç©ºï¼ˆç‰¹åˆ«æ˜¯ä¸“è¾‘ã€å¹´ä»½ã€æµæ´¾ã€æ›²ç›®å·ï¼‰
- ä»£ç ä¼šæ™ºèƒ½å¤„ç†ç¼ºå¤±çš„æ•°æ®ï¼Œåªæ›´æ–°å¯ç”¨çš„å­—æ®µ

### 3. æµæ´¾å­—æ®µçš„ç‰¹æ®Šæ€§
- å½“å‰ä»£ç ä¸­çš„ "æµæ´¾" å­—æ®µå®é™…ä¸Šå­˜å‚¨çš„æ˜¯ **ä¸“è¾‘ç±»å‹**ï¼ˆAlbum, Single, EP ç­‰ï¼‰
- ä¸æ˜¯ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„éŸ³ä¹æµæ´¾ï¼ˆå¦‚ Pop, Rock, Jazz ç­‰ï¼‰
- å¦‚æœéœ€è¦çœŸæ­£çš„éŸ³ä¹æµæ´¾ï¼Œéœ€è¦ä»å…¶ä»–æ•°æ®æºè·å–

### 4. ç½®ä¿¡åº¦é˜ˆå€¼
- åªæœ‰å½“ AcoustID API è¿”å›çš„åŒ¹é…åˆ†æ•° â‰¥ `CONFIDENCE_THRESHOLD`ï¼ˆé»˜è®¤ 0.7ï¼‰æ—¶ï¼Œæ‰ä¼šæ›´æ–°æ ‡ç­¾
- è¿™ç¡®ä¿äº†åªæœ‰é«˜ç½®ä¿¡åº¦çš„åŒ¹é…æ‰ä¼šè¢«åº”ç”¨

---

## ğŸš€ æœªæ¥å¯èƒ½çš„æ‰©å±•

ä»¥ä¸‹æ ‡ç­¾å­—æ®µç›®å‰**ä¸æ”¯æŒ**ï¼Œä½†å¯ä»¥æ‰©å±•ï¼š

- **ä½œæ›²è€…** (Composer)
- **ä½œè¯è€…** (Lyricist)
- **ä¸“è¾‘è‰ºæœ¯å®¶** (Album Artist)
- **å…‰ç›˜ç¼–å·** (Disc Number)
- **æ€»æ›²ç›®æ•°** (Total Tracks)
- **BPM** (Beats Per Minute)
- **è¯„è®º** (Comment)
- **å°é¢å›¾ç‰‡** (Album Art/Cover)
- **éŸ³ä¹æµæ´¾** (çœŸæ­£çš„éŸ³ä¹æµæ´¾ï¼Œè€Œéä¸“è¾‘ç±»å‹)

å¦‚æœéœ€è¦æ·»åŠ è¿™äº›å­—æ®µï¼Œéœ€è¦ï¼š
1. ä¿®æ”¹ `update_tags` å‡½æ•°
2. ä» AcoustID API æˆ–å…¶ä»–æ•°æ®æºè·å–ç›¸åº”ä¿¡æ¯
3. ä¸ºæ¯ç§æ ¼å¼å®ç°å¯¹åº”çš„æ ‡ç­¾å†™å…¥é€»è¾‘

---

## ğŸ“ ä»£ç ä½ç½®

æ ‡ç­¾æ›´æ–°é€»è¾‘ä½äºï¼š
- `diskjockey.py` - ç¬¬ 105-176 è¡Œï¼ˆ`update_tags` å‡½æ•°ï¼‰
- `diskjockey_nas.py` - ç¬¬ 114-185 è¡Œï¼ˆ`update_tags` å‡½æ•°ï¼‰

æ•°æ®æå–é€»è¾‘ä½äºï¼š
- `diskjockey.py` - ç¬¬ 178-313 è¡Œï¼ˆ`run_disk_jockey` å‡½æ•°ï¼‰
- `diskjockey_nas.py` - ç¬¬ 187-363 è¡Œï¼ˆ`run_disk_jockey` å‡½æ•°ï¼‰

---

**æœ€åæ›´æ–°**ï¼šå·²æ”¯æŒ 6 ä¸ªæ ‡ç­¾å­—æ®µï¼Œè¦†ç›–æ‰€æœ‰ä¸»è¦éŸ³é¢‘æ ¼å¼

